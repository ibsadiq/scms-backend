# Generated by Django 5.1 on 2025-12-21 12:25

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('academic', '0008_alter_studentclassenrollment_academic_year_and_more'),
        ('administration', '0002_initial'),
        ('finance', '0004_alter_feestructure_options_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AdmissionApplication',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('application_number', models.CharField(editable=False, help_text='Auto-generated (e.g., ADM/2025/001)', max_length=20, unique=True)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('submitted', 'Submitted'), ('under_review', 'Under Review'), ('documents_pending', 'Documents Pending'), ('exam_scheduled', 'Exam Scheduled'), ('exam_completed', 'Exam Completed'), ('interview_scheduled', 'Interview Scheduled'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('accepted', 'Accepted'), ('enrolled', 'Enrolled'), ('withdrawn', 'Withdrawn')], default='draft', max_length=30)),
                ('first_name', models.CharField(max_length=100)),
                ('middle_name', models.CharField(blank=True, max_length=100)),
                ('last_name', models.CharField(max_length=100)),
                ('gender', models.CharField(choices=[('Male', 'Male'), ('Female', 'Female'), ('Other', 'Other')], max_length=10)),
                ('date_of_birth', models.DateField()),
                ('state_of_origin', models.CharField(help_text='Nigerian state of origin', max_length=100)),
                ('lga', models.CharField(help_text='Local Government Area', max_length=100)),
                ('religion', models.CharField(blank=True, choices=[('Islam', 'Islam'), ('Christian', 'Christian'), ('Other', 'Other')], max_length=50, null=True)),
                ('blood_group', models.CharField(blank=True, help_text='e.g., O+, A-, AB+', max_length=5)),
                ('address', models.TextField(help_text='Residential address')),
                ('city', models.CharField(max_length=100)),
                ('parent_first_name', models.CharField(max_length=100)),
                ('parent_last_name', models.CharField(max_length=100)),
                ('parent_email', models.EmailField(max_length=254)),
                ('parent_phone', models.CharField(max_length=15)),
                ('parent_occupation', models.CharField(blank=True, max_length=100)),
                ('parent_relationship', models.CharField(choices=[('father', 'Father'), ('mother', 'Mother'), ('guardian', 'Guardian'), ('other', 'Other')], default='father', max_length=50)),
                ('alt_contact_name', models.CharField(blank=True, help_text='Alternative emergency contact', max_length=200)),
                ('alt_contact_phone', models.CharField(blank=True, max_length=15)),
                ('alt_contact_relationship', models.CharField(blank=True, max_length=100)),
                ('previous_school', models.CharField(blank=True, help_text='Name of previous school (if any)', max_length=255)),
                ('previous_class', models.CharField(blank=True, help_text='Last class attended', max_length=100)),
                ('medical_conditions', models.TextField(blank=True, help_text='Any medical conditions or allergies')),
                ('special_needs', models.TextField(blank=True, help_text='Any special educational needs')),
                ('application_fee_paid', models.BooleanField(default=False)),
                ('application_fee_payment_date', models.DateTimeField(blank=True, null=True)),
                ('exam_fee_paid', models.BooleanField(default=False)),
                ('exam_fee_payment_date', models.DateTimeField(blank=True, null=True)),
                ('acceptance_fee_paid', models.BooleanField(default=False)),
                ('acceptance_fee_payment_date', models.DateTimeField(blank=True, null=True)),
                ('acceptance_deadline', models.DateTimeField(blank=True, help_text='Deadline to accept offer (calculated from approval date)', null=True)),
                ('admin_notes', models.TextField(blank=True, help_text='Internal notes from admin review')),
                ('rejection_reason', models.TextField(blank=True, help_text='Reason for rejection (if applicable)')),
                ('submitted_at', models.DateTimeField(blank=True, null=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('accepted_at', models.DateTimeField(blank=True, help_text='When parent accepted the offer', null=True)),
                ('enrolled_at', models.DateTimeField(blank=True, null=True)),
                ('tracking_token', models.CharField(editable=False, help_text='Secure token for external application tracking', max_length=64, unique=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('acceptance_fee_receipt', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='acceptance_fees', to='finance.receipt')),
                ('application_fee_receipt', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='application_fees', to='finance.receipt')),
                ('applying_for_class', models.ForeignKey(help_text='Class student is applying for', on_delete=django.db.models.deletion.CASCADE, to='academic.classlevel')),
                ('enrolled_student', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='admission_application', to='academic.student')),
                ('exam_fee_receipt', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='exam_fees', to='finance.receipt')),
                ('reviewed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='reviewed_applications', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Admission Application',
                'verbose_name_plural': 'Admission Applications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AdmissionAssessment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('assessment_type', models.CharField(choices=[('entrance_exam', 'Entrance Examination'), ('interview', 'Interview'), ('aptitude_test', 'Aptitude Test'), ('screening', 'Screening Test'), ('oral_test', 'Oral Test'), ('practical', 'Practical Assessment'), ('psychometric', 'Psychometric Test'), ('portfolio_review', 'Portfolio Review')], max_length=30)),
                ('scheduled_date', models.DateTimeField()),
                ('duration_minutes', models.PositiveIntegerField(default=60, help_text='Duration in minutes')),
                ('venue', models.CharField(blank=True, max_length=255)),
                ('status', models.CharField(choices=[('scheduled', 'Scheduled'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('no_show', 'No Show'), ('cancelled', 'Cancelled')], default='scheduled', max_length=20)),
                ('overall_score', models.DecimalField(blank=True, decimal_places=2, help_text='Overall score achieved', max_digits=5, null=True)),
                ('max_score', models.DecimalField(decimal_places=2, default=100, help_text='Maximum possible score', max_digits=5)),
                ('pass_mark', models.DecimalField(decimal_places=2, default=50, help_text='Minimum score to pass', max_digits=5)),
                ('passed', models.BooleanField(default=False, help_text='Whether student passed this assessment')),
                ('assessor_notes', models.TextField(blank=True, help_text='General notes from assessor')),
                ('strengths', models.TextField(blank=True, help_text="Student's strengths observed")),
                ('areas_for_improvement', models.TextField(blank=True, help_text='Areas needing improvement')),
                ('recommendation', models.CharField(blank=True, choices=[('highly_recommended', 'Highly Recommended'), ('recommended', 'Recommended'), ('conditional', 'Conditional'), ('not_recommended', 'Not Recommended')], help_text='Overall recommendation', max_length=20)),
                ('instructions', models.TextField(blank=True, help_text='Instructions for this assessment')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('application', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assessments', to='academic.admissionapplication')),
                ('assessor', models.ForeignKey(blank=True, help_text='Staff member conducting assessment', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='conducted_assessments', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Admission Assessment',
                'verbose_name_plural': 'Admission Assessments',
                'ordering': ['scheduled_date'],
            },
        ),
        migrations.CreateModel(
            name='AdmissionDocument',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('document_type', models.CharField(choices=[('birth_certificate', 'Birth Certificate'), ('passport_photo', 'Passport Photograph'), ('previous_results', 'Previous School Results'), ('transfer_certificate', 'Transfer Certificate'), ('medical_records', 'Medical Records'), ('immunization_card', 'Immunization Card'), ('other', 'Other Document')], max_length=30)),
                ('file', models.FileField(upload_to='admission_documents/%Y/%m/', validators=[django.core.validators.FileExtensionValidator(allowed_extensions=['pdf', 'jpg', 'jpeg', 'png'])])),
                ('description', models.CharField(blank=True, max_length=255)),
                ('verified', models.BooleanField(default=False, help_text='Has admin verified this document?')),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('verification_notes', models.TextField(blank=True)),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('application', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='academic.admissionapplication')),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='verified_documents', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Admission Document',
                'verbose_name_plural': 'Admission Documents',
                'ordering': ['-uploaded_at'],
            },
        ),
        migrations.CreateModel(
            name='AdmissionSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text="Example: '2025/2026 New Students Admission'", max_length=100)),
                ('start_date', models.DateField(help_text='When applications open')),
                ('end_date', models.DateField(help_text='When applications close')),
                ('require_acceptance_fee', models.BooleanField(default=True, help_text='Whether this session requires acceptance fees')),
                ('acceptance_fee_deadline_days', models.PositiveIntegerField(default=14, help_text='Days after approval to pay acceptance fee and accept offer')),
                ('application_number_prefix', models.CharField(default='ADM', help_text="Prefix for application numbers (e.g., 'ADM' -> ADM/2025/001)", max_length=10)),
                ('allow_public_applications', models.BooleanField(default=True, help_text='Allow external applications without login')),
                ('send_confirmation_emails', models.BooleanField(default=True, help_text='Send email confirmations to applicants')),
                ('application_instructions', models.TextField(blank=True, help_text='Instructions shown to parents at the start of application')),
                ('approval_message', models.TextField(blank=True, help_text='Custom message sent when application is approved')),
                ('rejection_message_template', models.TextField(blank=True, help_text='Template for rejection messages')),
                ('is_active', models.BooleanField(default=True, help_text='Only one session should be active at a time')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('academic_year', models.OneToOneField(help_text='Academic year this admission session is for', on_delete=django.db.models.deletion.CASCADE, related_name='admission_session', to='administration.academicyear')),
            ],
            options={
                'verbose_name': 'Admission Session',
                'verbose_name_plural': 'Admission Sessions',
                'ordering': ['-start_date'],
            },
        ),
        migrations.CreateModel(
            name='AdmissionFeeStructure',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('application_fee', models.DecimalField(decimal_places=2, default=0, help_text='Fee to submit application', max_digits=10)),
                ('application_fee_required', models.BooleanField(default=True, help_text='Must pay application fee to submit')),
                ('entrance_exam_required', models.BooleanField(default=False, help_text='Does this class require entrance exam?')),
                ('entrance_exam_fee', models.DecimalField(decimal_places=2, default=0, help_text='Fee to take entrance exam', max_digits=10)),
                ('entrance_exam_pass_score', models.DecimalField(blank=True, decimal_places=2, help_text='Minimum score to pass entrance exam (percentage)', max_digits=5, null=True)),
                ('interview_required', models.BooleanField(default=False, help_text='Does this class require interview?')),
                ('acceptance_fee', models.DecimalField(decimal_places=2, default=0, help_text='Fee to accept admission offer', max_digits=10)),
                ('acceptance_fee_required', models.BooleanField(default=True, help_text='Must pay acceptance fee to accept offer')),
                ('acceptance_fee_is_part_of_tuition', models.BooleanField(default=True, help_text='If True, acceptance fee is deducted from first term tuition')),
                ('max_applications', models.PositiveIntegerField(blank=True, help_text='Maximum number of applications for this class (optional)', null=True)),
                ('minimum_age', models.PositiveIntegerField(blank=True, help_text='Minimum age in years (optional)', null=True)),
                ('maximum_age', models.PositiveIntegerField(blank=True, help_text='Maximum age in years (optional)', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('class_room', models.ForeignKey(help_text='Class level (e.g., Primary 1, JSS 1)', on_delete=django.db.models.deletion.CASCADE, to='academic.classlevel')),
                ('admission_session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='fee_structures', to='academic.admissionsession')),
            ],
            options={
                'verbose_name': 'Admission Fee Structure',
                'verbose_name_plural': 'Admission Fee Structures',
                'ordering': ['class_room__id'],
            },
        ),
        migrations.AddField(
            model_name='admissionapplication',
            name='admission_session',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='applications', to='academic.admissionsession'),
        ),
        migrations.CreateModel(
            name='AssessmentCriterion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text="e.g., 'Mathematics', 'Communication Skills'", max_length=255)),
                ('max_score', models.DecimalField(decimal_places=2, help_text='Maximum score for this criterion', max_digits=5)),
                ('achieved_score', models.DecimalField(decimal_places=2, default=0, help_text='Score achieved by student', max_digits=5)),
                ('weight', models.DecimalField(decimal_places=2, default=1.0, help_text='Weight/importance multiplier (default 1.0)', max_digits=4)),
                ('comments', models.TextField(blank=True, help_text='Specific feedback for this criterion')),
                ('order', models.PositiveIntegerField(default=0, help_text='Display order')),
                ('assessment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='criteria', to='academic.admissionassessment')),
            ],
            options={
                'verbose_name': 'Assessment Criterion',
                'verbose_name_plural': 'Assessment Criteria',
                'ordering': ['order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='AssessmentTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text="e.g., 'JSS 1 Entrance Exam', 'Primary Interview'", max_length=255)),
                ('assessment_type', models.CharField(choices=[('entrance_exam', 'Entrance Examination'), ('interview', 'Interview'), ('aptitude_test', 'Aptitude Test'), ('screening', 'Screening Test'), ('oral_test', 'Oral Test'), ('practical', 'Practical Assessment'), ('psychometric', 'Psychometric Test'), ('portfolio_review', 'Portfolio Review')], max_length=30)),
                ('description', models.TextField(blank=True)),
                ('default_duration_minutes', models.PositiveIntegerField(default=60, help_text='Default duration in minutes')),
                ('default_max_score', models.DecimalField(decimal_places=2, default=100, help_text='Default maximum score', max_digits=5)),
                ('default_pass_mark', models.DecimalField(decimal_places=2, default=50, help_text='Default pass mark', max_digits=5)),
                ('default_instructions', models.TextField(blank=True, help_text='Default instructions for this assessment')),
                ('is_active', models.BooleanField(default=True, help_text='Only active templates are available for use')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('applicable_classes', models.ManyToManyField(blank=True, help_text='Which class levels can use this template', to='academic.classlevel')),
            ],
            options={
                'verbose_name': 'Assessment Template',
                'verbose_name_plural': 'Assessment Templates',
                'ordering': ['assessment_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='AssessmentTemplateCriterion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text="e.g., 'Mathematics', 'Communication Skills'", max_length=255)),
                ('max_score', models.DecimalField(decimal_places=2, help_text='Maximum score for this criterion', max_digits=5)),
                ('weight', models.DecimalField(decimal_places=2, default=1.0, help_text='Weight/importance multiplier', max_digits=4)),
                ('description', models.TextField(blank=True, help_text='What this criterion assesses')),
                ('order', models.PositiveIntegerField(default=0, help_text='Display order')),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='template_criteria', to='academic.assessmenttemplate')),
            ],
            options={
                'verbose_name': 'Assessment Template Criterion',
                'verbose_name_plural': 'Assessment Template Criteria',
                'ordering': ['order', 'name'],
            },
        ),
        migrations.AddIndex(
            model_name='admissionassessment',
            index=models.Index(fields=['scheduled_date'], name='academic_ad_schedul_40589c_idx'),
        ),
        migrations.AddIndex(
            model_name='admissionassessment',
            index=models.Index(fields=['status'], name='academic_ad_status_2bb14e_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='admissionfeestructure',
            unique_together={('admission_session', 'class_room')},
        ),
        migrations.AddIndex(
            model_name='admissionapplication',
            index=models.Index(fields=['application_number'], name='academic_ad_applica_0ced74_idx'),
        ),
        migrations.AddIndex(
            model_name='admissionapplication',
            index=models.Index(fields=['status'], name='academic_ad_status_a98888_idx'),
        ),
        migrations.AddIndex(
            model_name='admissionapplication',
            index=models.Index(fields=['tracking_token'], name='academic_ad_trackin_a0180b_idx'),
        ),
        migrations.AddIndex(
            model_name='admissionapplication',
            index=models.Index(fields=['parent_email'], name='academic_ad_parent__84c206_idx'),
        ),
    ]
